#include "emotion_code.h"

#include <stdint.h>

#include <algorithm>

using namespace std;

static uint16_t Utf8ToUnicodeW(const char *szStr)
{
	uint16_t wRet = 0;
	if ((szStr[0] & 0xf0) == 0xe0 ||
		(szStr[1] & 0xc0) == 0x80 ||
		(szStr[2] & 0xc0) == 0x80)
	{
		uint8_t cHigh = ((szStr[0] & 0x0f) << 4) + ((szStr[1] >> 2) & 0x0f);
		uint8_t cLow  = ((szStr[1] & 0x03) << 6) + (szStr[2] & 0x3f);
		wRet = (cHigh << 8) + cLow;
	}
	return wRet;
}

static uint32_t Utf8ToUnicodeDW(const char *szStr)
{
	uint32_t dwRet = 0;
	if ((szStr[0] & 0xff) == 0xf0 ||
		(szStr[1] & 0xc0) == 0x80 ||
		(szStr[2] & 0xc0) == 0x80 ||
		(szStr[3] & 0xc0) == 0x80)
	{
		uint8_t cHigh   = ((szStr[0] << 2) & 0x1c)  + ((szStr[1] >> 4) & 0x03);
		uint8_t cMiddle = (szStr[1] << 4) + ((szStr[2] >> 2) & 0x0f);
		uint8_t cLow    = (szStr[2] << 6) + (szStr[3] & 0x3f);
		dwRet = (cHigh << 16) + (cMiddle << 8) + cLow;
	}
	return dwRet;
}

extern "C" {
typedef struct {
	uint32_t     dwUnicode;
	const char  *szTips;
} EmojiToChinese;
}

class EmojiToChineseComp
{
public:
	bool operator()(const EmojiToChinese &a, const EmojiToChinese &b) const
	{
		return a.dwUnicode < b.dwUnicode;
	}
};

static const EmojiToChinese stEmojis[] = {
	/* 0xe001 ~ 0xe537 */
	{0xe001, "/z男孩"},
	{0xe002, "/z女孩"},
	{0xe003, "/z吻"},
	{0xe004, "/z爸爸"},
	{0xe005, "/z妈妈"},
	{0xe006, "/z上衣"},
	{0xe007, "/z男鞋"},
	{0xe008, "/z相机"},
	{0xe009, "/z电话"},
	{0xe00a, "/z手机"},
	{0xe00b, "/z传真"},
	{0xe00c, "/z电脑"},
	{0xe00d, "/z出拳"},
	{0xe00e, "/z强"},
	{0xe00f, "/z第一"},
	{0xe010, "/z拳头"},
	{0xe011, "/z胜利"},
	{0xe012, "/z停"},
	{0xe013, "/z滑雪"},
	{0xe014, "/z高尔夫"},
	{0xe015, "/z网球"},
	{0xe016, "/z棒球"},
	{0xe017, "/z冲浪"},
	{0xe018, "/z足球"},
	{0xe019, "/z鱼儿"},
	{0xe01a, "/z小马"},
	{0xe01b, "/z小车"},
	{0xe01c, "/z帆船"},
	{0xe01d, "/z飞机"},
	{0xe01e, "/z电车"},
	{0xe01f, "/z高铁"},
	{0xe020, "/z问号"},
	{0xe021, "/z叹号"},
	{0xe022, "/z爱心"},
	{0xe023, "/z心碎"},
	{0xe024, "/z一点"},
	{0xe025, "/z二点"},
	{0xe026, "/z三点"},
	{0xe027, "/z四点"},
	{0xe028, "/z五点"},
	{0xe029, "/z六点"},
	{0xe02a, "/z七点"},
	{0xe02b, "/z八点"},
	{0xe02c, "/z九点"},
	{0xe02d, "/z十点"},
	{0xe02e, "/z十一点"},
	{0xe02f, "/z十二点"},
	{0xe030, "/z桃花"},
	{0xe031, "/z金冠"},
	{0xe032, "/z玫瑰"},
	{0xe033, "/z圣诞树"},
	{0xe034, "/z戒指"},
	{0xe035, "/z钻石"},
	{0xe036, "/z房子"},
	{0xe037, "/z教堂"},
	{0xe038, "/z大厦"},
	{0xe039, "/z火车"},
	{0xe03a, "/z加油站"},
	{0xe03b, "/z富士山"},
	{0xe03c, "/z唱歌"},
	{0xe03d, "/z摄像机"},
	{0xe03e, "/z音乐"},
	{0xe03f, "/z钥匙"},
	{0xe040, "/z萨克斯"},
	{0xe041, "/z吉他"},
	{0xe042, "/z喇叭"},
	{0xe043, "/z刀叉"},
	{0xe044, "/z鸡尾酒"},
	{0xe045, "/z咖啡"},
	{0xe046, "/z蛋糕"},
	{0xe047, "/z啤酒"},
	{0xe048, "/z雪人"},
	{0xe049, "/z多云"},
	{0xe04a, "/z太阳"},
	{0xe04b, "/z下雨"},
	{0xe04c, "/z月亮"},
	{0xe04d, "/z朝阳"},
	{0xe04e, "/z天使"},
	{0xe04f, "/z猫咪"},
	{0xe050, "/z老虎"},
	{0xe051, "/z灰熊"},
	{0xe052, "/z狗狗"},
	{0xe053, "/z灰鼠"},
	{0xe054, "/z鲸"},
	{0xe055, "/z啄木鸟"},
	{0xe056, "/z可爱"},
	{0xe057, "/z开心"},
	{0xe058, "/z伤心"},
	{0xe059, "/z生气"},
	{0xe05a, "/z便便"},
	{0xe101, "/z收件箱"},
	{0xe102, "/z信箱"},
	{0xe103, "/z来信"},
	{0xe104, "/z来电"},
	{0xe105, "/z调皮"},
	{0xe106, "/z色"},
	{0xe107, "/z恐怖"},
	{0xe108, "/z汗"},
	{0xe109, "/z猴子"},
	{0xe10a, "/z章鱼"},
	{0xe10b, "/z猪头"},
	{0xe10c, "/z外星人"},
	{0xe10d, "/z火箭"},
	{0xe10e, "/z皇冠"},
	{0xe10f, "/z灯泡"},
	{0xe110, "/z四叶草"},
	{0xe111, "/z接吻"},
	{0xe112, "/z礼物"},
	{0xe113, "/z手枪"},
	{0xe114, "/z放大镜"},
	{0xe115, "/z跑步"},
	{0xe116, "/z榔头"},
	{0xe117, "/z烟花"},
	{0xe118, "/z枫叶"},
	{0xe119, "/z黄叶"},
	{0xe11a, "/z魔鬼"},
	{0xe11b, "/z小鬼"},
	{0xe11c, "/z骷髅"},
	{0xe11d, "/z火焰"},
	{0xe11e, "/z男包"},
	{0xe11f, "/z座椅"},
	{0xe120, "/z汉堡"},
	{0xe121, "/z喷泉"},
	{0xe122, "/z帐篷"},
	{0xe123, "/z温泉"},
	{0xe124, "/z摩天轮"},
	{0xe125, "/z钞票"},
	{0xe126, "/z光盘"},
	{0xe127, "/zCD"},
	{0xe128, "/z收音机"},
	{0xe129, "/z磁带"},
	{0xe12a, "/z电视"},
	{0xe12b, "/z打怪"},
	{0xe12c, "/z道具"},
	{0xe12d, "/z麻将"},
	{0xe12e, "/z对战"},
	{0xe12f, "/z金钱"},
	{0xe130, "/z箭靶"},
	{0xe131, "/z奖杯"},
	{0xe132, "/z黑白格旗"},
	{0xe133, "/z密码锁"},
	{0xe134, "/z骏马"},
	{0xe135, "/z快艇"},
	{0xe136, "/z单车"},
	{0xe137, "/z路障"},
	{0xe138, "/z男厕"},
	{0xe139, "/z女厕"},
	{0xe13a, "/z婴儿"},
	{0xe13b, "/z针管"},
	{0xe13c, "/z睡觉"},
	{0xe13d, "/z闪电"},
	{0xe13e, "/z高跟鞋"},
	{0xe13f, "/z浴缸"},
	{0xe140, "/z马桶"},
	{0xe141, "/z声音"},
	{0xe142, "/z大喇叭"},
	{0xe143, "/z日本旗"},
	{0xe144, "/z锁头"},
	{0xe145, "/z开锁"},
	{0xe146, "/z傍晚"},
	{0xe147, "/z鸡蛋"},
	{0xe148, "/z书"},
	{0xe149, "/z汇率"},
	{0xe14a, "/z股价"},
	{0xe14b, "/z广播"},
	{0xe14c, "/z肌肉"},
	{0xe14d, "/z银行"},
	{0xe14e, "/z红绿灯"},
	{0xe14f, "/z停车"},
	{0xe150, "/z路牌"},
	{0xe151, "/z厕所"},
	{0xe152, "/z警察"},
	{0xe153, "/z楼房"},
	{0xe154, "/z取款机"},
	{0xe155, "/z医院"},
	{0xe156, "/z便利店"},
	{0xe157, "/z学校"},
	{0xe158, "/z酒店"},
	{0xe159, "/z公交车"},
	{0xe15a, "/z出租车"},
	{0xe201, "/z走路"},
	{0xe202, "/z游轮"},
	{0xe203, "/z这里"},
	{0xe204, "/z心"},
	{0xe205, "/z标记"},
	{0xe206, "/z星号"},
	{0xe207, "/z十八禁"},
	{0xe208, "/z禁烟"},
	{0xe209, "/z盾牌"},
	{0xe20a, "/z轮椅"},
	{0xe20b, "/z信号"},
	{0xe20c, "/z红心"},
	{0xe20d, "/z方块"},
	{0xe20e, "/z黑桃"},
	{0xe20f, "/z梅花"},
	{0xe210, "/z井号"},
	{0xe211, "/z眼镜"},
	{0xe212, "/z新"},
	{0xe213, "/z向上"},
	{0xe214, "/z酷"},
	{0xe215, "/z是"},
	{0xe216, "/z无"},
	{0xe217, "/z本月"},
	{0xe218, "/z报名"},
	{0xe219, "/z红"},
	{0xe21a, "/z绿"},
	{0xe21b, "/z紫"},
	{0xe21c, "/z一"},
	{0xe21d, "/z二"},
	{0xe21e, "/z三"},
	{0xe21f, "/z四"},
	{0xe220, "/z五"},
	{0xe221, "/z六"},
	{0xe222, "/z七"},
	{0xe223, "/z八"},
	{0xe224, "/z九"},
	{0xe225, "/z零"},
	{0xe226, "/z获取"},
	{0xe227, "/z转让"},
	{0xe228, "/z平假名"},
	{0xe229, "/zID"},
	{0xe22a, "/z满"},
	{0xe22b, "/z空"},
	{0xe22c, "/z手指"},
	{0xe22d, "/z营业中"},
	{0xe22e, "/z向上"},
	{0xe22f, "/z向下"},
	{0xe230, "/z向左"},
	{0xe231, "/z向右"},
	{0xe232, "/z向上"},
	{0xe233, "/z向下"},
	{0xe234, "/z向右"},
	{0xe235, "/z向左"},
	{0xe236, "/z右上"},
	{0xe237, "/z左上"},
	{0xe238, "/z右下"},
	{0xe239, "/z左下"},
	{0xe23a, "/z右箭头"},
	{0xe23b, "/z左箭头"},
	{0xe23c, "/z快进"},
	{0xe23d, "/z快退"},
	{0xe23e, "/z星座"},
	{0xe23f, "/z白羊"},
	{0xe240, "/z金牛"},
	{0xe241, "/z双子"},
	{0xe242, "/z巨蟹"},
	{0xe243, "/z狮子"},
	{0xe244, "/z处女"},
	{0xe245, "/z天秤"},
	{0xe246, "/z天蝎"},
	{0xe247, "/z射手"},
	{0xe248, "/z摩羯"},
	{0xe249, "/z水瓶"},
	{0xe24a, "/z双鱼"},
	{0xe24b, "/z图标"},
	{0xe24c, "/z顶"},
	{0xe24d, "/zOK"},
	{0xe24e, "/z版权"},
	{0xe24f, "/z注册"},
	{0xe250, "/z手机"},
	{0xe251, "/z关机"},
	{0xe252, "/z警告"},
	{0xe253, "/z摆手"},
	{0xe301, "/z写字"},
	{0xe302, "/z衬衫"},
	{0xe303, "/z鲜花"},
	{0xe304, "/z郁金香"},
	{0xe305, "/z向日葵"},
	{0xe306, "/z康乃馨"},
	{0xe307, "/z椰树"},
	{0xe308, "/z仙人掌"},
	{0xe309, "/z厕所"},
	{0xe30a, "/z听歌"},
	{0xe30b, "/z米酒"},
	{0xe30c, "/z对饮"},
	{0xe30d, "/z祝福"},
	{0xe30e, "/z香烟"},
	{0xe30f, "/z药丸"},
	{0xe310, "/z气球"},
	{0xe311, "/z炸弹"},
	{0xe312, "/z礼花"},
	{0xe313, "/z剪刀"},
	{0xe314, "/z蝴蝶结"},
	{0xe315, "/z保密"},
	{0xe316, "/z唱片"},
	{0xe317, "/z小喇叭"},
	{0xe318, "/z草帽"},
	{0xe319, "/z连衣裙"},
	{0xe31a, "/z女鞋"},
	{0xe31b, "/z靴子"},
	{0xe31c, "/z口红"},
	{0xe31d, "/z美甲"},
	{0xe31e, "/z洗头"},
	{0xe31f, "/z剪发"},
	{0xe320, "/z理发店"},
	{0xe321, "/z和服"},
	{0xe322, "/z内衣"},
	{0xe323, "/z女包"},
	{0xe324, "/z电影"},
	{0xe325, "/z铃铛"},
	{0xe326, "/z音符"},
	{0xe327, "/z喜欢"},
	{0xe328, "/z粉心"},
	{0xe329, "/z爱神箭"},
	{0xe32a, "/z篮心"},
	{0xe32b, "/z绿心"},
	{0xe32c, "/z黄心"},
	{0xe32d, "/z紫心"},
	{0xe32e, "/z星星"},
	{0xe32f, "/z金星"},
	{0xe330, "/z喷气"},
	{0xe331, "/z水滴"},
	{0xe332, "/z圈"},
	{0xe333, "/z叉"},
	{0xe334, "/z青筋"},
	{0xe335, "/z金星"},
	{0xe336, "/z问号"},
	{0xe337, "/z叹号"},
	{0xe338, "/z绿茶"},
	{0xe339, "/z面包"},
	{0xe33a, "/z冰淇淋"},
	{0xe33b, "/z薯条"},
	{0xe33c, "/z丸子"},
	{0xe33d, "/z点心"},
	{0xe33e, "/z米饭"},
	{0xe33f, "/z意面"},
	{0xe340, "/z面条"},
	{0xe341, "/z盖浇饭"},
	{0xe342, "/z饭团"},
	{0xe343, "/z关东煮"},
	{0xe344, "/z寿司"},
	{0xe345, "/z苹果"},
	{0xe346, "/z橙子"},
	{0xe347, "/z草莓"},
	{0xe348, "/z西瓜"},
	{0xe349, "/z番茄"},
	{0xe34a, "/z茄子"},
	{0xe34b, "/z生日蛋糕"},
	{0xe34c, "/z盒饭"},
	{0xe34d, "/z汤"},
	{0xe401, "/z流汗"},
	{0xe402, "/z奸笑"},
	{0xe403, "/z惆怅"},
	{0xe404, "/z呲牙"},
	{0xe405, "/z挤眼"},
	{0xe406, "/z晕"},
	{0xe407, "/z崩溃"},
	{0xe408, "/z瞌睡"},
	{0xe409, "/z赖皮"},
	{0xe40a, "/z思考"},
	{0xe40b, "/z衰"},
	{0xe40c, "/z感冒"},
	{0xe40d, "/z发呆"},
	{0xe40e, "/z无感"},
	{0xe40f, "/z冷汗"},
	{0xe410, "/z混乱"},
	{0xe411, "/z大哭"},
	{0xe412, "/z笑抽"},
	{0xe413, "/z流泪"},
	{0xe414, "/z害羞"},
	{0xe415, "/z大笑"},
	{0xe416, "/z发怒"},
	{0xe417, "/z亲亲"},
	{0xe418, "/z飞吻"},
	{0xe419, "/z眼睛"},
	{0xe41a, "/z鼻子"},
	{0xe41b, "/z耳朵"},
	{0xe41c, "/z嘴唇"},
	{0xe41d, "/z拜佛"},
	{0xe41e, "/z手掌"},
	{0xe41f, "/z鼓掌"},
	{0xe420, "/zOK"},
	{0xe421, "/z鄙视"},
	{0xe422, "/z双手"},
	{0xe423, "/z交叉"},
	{0xe424, "/z抱头"},
	{0xe425, "/z爱情"},
	{0xe426, "/z考试"},
	{0xe427, "/z不是我"},
	{0xe428, "/z情侣"},
	{0xe429, "/z跳舞"},
	{0xe42a, "/z篮球"},
	{0xe42b, "/z橄榄球"},
	{0xe42c, "/z台球"},
	{0xe42d, "/z游泳"},
	{0xe42e, "/z汽车"},
	{0xe42f, "/z卡车"},
	{0xe430, "/z消防车"},
	{0xe431, "/z救护车"},
	{0xe432, "/z警车"},
	{0xe433, "/z过山车"},
	{0xe434, "/z列车"},
	{0xe435, "/z动车"},
	{0xe436, "/z盆景"},
	{0xe437, "/z爱的礼物"},
	{0xe438, "/z婚礼"},
	{0xe439, "/z套装"},
	{0xe43a, "/z箱子"},
	{0xe43b, "/z鲤鱼旗"},
	{0xe43c, "/z雨伞"},
	{0xe43d, "/z爱心教堂"},
	{0xe43e, "/z浪花"},
	{0xe43f, "/z刨冰"},
	{0xe440, "/z焰火"},
	{0xe441, "/z贝壳"},
	{0xe442, "/z风铃"},
	{0xe443, "/z晕"},
	{0xe444, "/z兰花"},
	{0xe445, "/z南瓜灯"},
	{0xe446, "/z夜色"},
	{0xe447, "/z绿叶"},
	{0xe448, "/z圣诞老人"},
	{0xe449, "/z夕阳"},
	{0xe44a, "/z黄昏"},
	{0xe44b, "/z流星"},
	{0xe44c, "/z彩虹"},
	{0xe501, "/z爱心酒店"},
	{0xe502, "/z绘画"},
	{0xe503, "/z礼貌"},
	{0xe504, "/z警局"},
	{0xe505, "/z亭子"},
	{0xe506, "/z城堡"},
	{0xe507, "/z摄影"},
	{0xe508, "/z烟囱"},
	{0xe509, "/z东京塔"},
	{0xe50a, "/z油罐"},
	{0xe50b, "/z日本"},
	{0xe50c, "/z美国"},
	{0xe50d, "/z法国"},
	{0xe50e, "/z德国"},
	{0xe50f, "/z意大利"},
	{0xe510, "/z英国"},
	{0xe511, "/z西班牙"},
	{0xe512, "/z俄罗斯"},
	{0xe513, "/z中国"},
	{0xe514, "/z韩国"},
	{0xe515, "/z学生"},
	{0xe516, "/z小贩"},
	{0xe517, "/z农民"},
	{0xe518, "/z爷爷"},
	{0xe519, "/z奶奶"},
	{0xe51a, "/z宝宝"},
	{0xe51b, "/z工人"},
	{0xe51c, "/z公主"},
	{0xe51d, "/z自由女神"},
	{0xe51e, "/z士兵"},
	{0xe51f, "/z美女"},
	{0xe520, "/z海豚"},
	{0xe521, "/z灰鸟"},
	{0xe522, "/z热带鱼"},
	{0xe523, "/z黄鸟"},
	{0xe524, "/z花鼠"},
	{0xe525, "/z毛毛虫"},
	{0xe526, "/z大象"},
	{0xe527, "/z考拉"},
	{0xe528, "/z小猴"},
	{0xe529, "/z绵羊"},
	{0xe52a, "/z狼狗"},
	{0xe52b, "/z牛"},
	{0xe52c, "/z兔子"},
	{0xe52d, "/z蛇"},
	{0xe52e, "/z小鸡"},
	{0xe52f, "/z野猪"},
	{0xe530, "/z骆驼"},
	{0xe531, "/z青蛙"},
	{0xe532, "/zA型"},
	{0xe533, "/zB型"},
	{0xe534, "/zAB型"},
	{0xe535, "/zO型"},
	{0xe536, "/z脚印"},
	{0xe537, "/z商标"},
	/* 0x1f300 ~ 0x1f64f */
	{0x1f300, "/z晕"},
	{0x1f302, "/z雨伞"},
	{0x1f303, "/z流星"},
	{0x1f304, "/z朝阳"},
	{0x1f305, "/z夕阳"},
	{0x1f306, "/z傍晚"},
	{0x1f307, "/z黄昏"},
	{0x1f308, "/z彩虹"},
	{0x1f30a, "/z浪花"},
	{0x1f319, "/z月亮"},
	{0x1f31f, "/z金星"},
	{0x1f334, "/z椰树"},
	{0x1f335, "/z仙人掌"},
	{0x1f337, "/z郁金香"},
	{0x1f338, "/z桃花"},
	{0x1f339, "/z玫瑰"},
	{0x1f33a, "/z鲜花"},
	{0x1f33b, "/z向日葵"},
	{0x1f33e, "/z兰花"},
	{0x1f340, "/z四叶草"},
	{0x1f341, "/z枫叶"},
	{0x1f342, "/z黄叶"},
	{0x1f343, "/z绿叶"},
	{0x1f345, "/z番茄"},
	{0x1f353, "/z草莓"},
	{0x1f354, "/z汉堡"},
	{0x1f358, "/z点心"},
	{0x1f359, "/z饭团"},
	{0x1f35a, "/z米饭"},
	{0x1f35b, "/z盖浇饭"},
	{0x1f35c, "/z面条"},
	{0x1f35d, "/z意面"},
	{0x1f35e, "/z面包"},
	{0x1f35f, "/z薯条"},
	{0x1f361, "/z丸子"},
	{0x1f362, "/z关东煮"},
	{0x1f363, "/z寿司"},
	{0x1f366, "/z冰淇淋"},
	{0x1f367, "/z刨冰"},
	{0x1f370, "/z蛋糕"},
	{0x1f371, "/z盒饭"},
	{0x1f372, "/z汤"},
	{0x1f373, "/z鸡蛋"},
	{0x1f374, "/z刀叉"},
	{0x1f375, "/z绿茶"},
	{0x1f376, "/z米酒"},
	{0x1f378, "/z鸡尾酒"},
	{0x1f37a, "/z啤酒"},
	{0x1f37b, "/z对饮"},
	{0x1f380, "/z蝴蝶结"},
	{0x1f381, "/z礼物"},
	{0x1f382, "/z生日蛋糕"},
	{0x1f383, "/z南瓜灯"},
	{0x1f384, "/z圣诞树"},
	{0x1f385, "/z圣诞老人"},
	{0x1f386, "/z烟花"},
	{0x1f387, "/z焰火"},
	{0x1f388, "/z气球"},
	{0x1f389, "/z礼花"},
	{0x1f38c, "/z日本旗"},
	{0x1f38d, "/z盆景"},
	{0x1f38e, "/z婚礼"},
	{0x1f38f, "/z鲤鱼旗"},
	{0x1f390, "/z风铃"},
	{0x1f391, "/z夜色"},
	{0x1f392, "/z箱子"},
	{0x1f393, "/z套装"},
	{0x1f3a1, "/z摩天轮"},
	{0x1f3a2, "/z过山车"},
	{0x1f3a4, "/z唱歌"},
	{0x1f3a5, "/z摄像机"},
	{0x1f3a6, "/z摄影"},
	{0x1f3a7, "/z听歌"},
	{0x1f3a8, "/z绘画"},
	{0x1f3a9, "/z礼帽"},
	{0x1f3ab, "/z钞票"},
	{0x1f3ac, "/z电影"},
	{0x1f3af, "/z箭靶"},
	{0x1f3b0, "/z密码锁"},
	{0x1f3b1, "/z台球"},
	{0x1f3b5, "/z音乐"},
	{0x1f3b6, "/z音符"},
	{0x1f3b7, "/z萨克斯"},
	{0x1f3b8, "/z吉他"},
	{0x1f3ba, "/z喇叭"},
	{0x1f3be, "/z网球"},
	{0x1f3bf, "/z滑雪"},
	{0x1f3c0, "/z篮球"},
	{0x1f3c1, "/z黑白格旗"},
	{0x1f3c3, "/z跑步"},
	{0x1f3c4, "/z冲浪"},
	{0x1f3c6, "/z奖杯"},
	{0x1f3c8, "/z橄榄球"},
	{0x1f3ca, "/z游泳"},
	{0x1f3e0, "/z房子"},
	{0x1f3e2, "/z大厦"},
	{0x1f3e3, "/z楼房"},
	{0x1f3e5, "/z医院"},
	{0x1f3e6, "/z银行"},
	{0x1f3e7, "/z取款机"},
	{0x1f3e8, "/z酒店"},
	{0x1f3e9, "/z爱心酒店"},
	{0x1f3ea, "/z便利店"},
	{0x1f3eb, "/z学校"},
	{0x1f3ec, "/z警局"},
	{0x1f3ed, "/z烟囱"},
	{0x1f3ef, "/z亭子"},
	{0x1f3f0, "/z城堡"},
	{0x1f40d, "/z蛇"},
	{0x1f40e, "/z骏马"},
	{0x1f411, "/z绵羊"},
	{0x1f412, "/z小猴"},
	{0x1f414, "/z小鸡"},
	{0x1f417, "/z野猪"},
	{0x1f418, "/z大象"},
	{0x1f419, "/z章鱼"},
	{0x1f41a, "/z贝壳"},
	{0x1f41b, "/z毛毛虫"},
	{0x1f41f, "/z鱼儿"},
	{0x1f420, "/z热带鱼"},
	{0x1f424, "/z黄鸟"},
	{0x1f426, "/z灰鸟"},
	{0x1f427, "/z啄木鸟"},
	{0x1f428, "/z考拉"},
	{0x1f42b, "/z骆驼"},
	{0x1f42c, "/z海豚"},
	{0x1f42d, "/z灰鼠"},
	{0x1f42e, "/z牛"},
	{0x1f42f, "/z老虎"},
	{0x1f430, "/z兔子"},
	{0x1f431, "/z猫咪"},
	{0x1f433, "/z鲸"},
	{0x1f434, "/z小马"},
	{0x1f435, "/z猴子"},
	{0x1f436, "/z狗狗"},
	{0x1f437, "/z猪头"},
	{0x1f438, "/z青蛙"},
	{0x1f439, "/z花鼠"},
	{0x1f43a, "/z狼狗"},
	{0x1f43b, "/z灰熊"},
	{0x1f440, "/z眼睛"},
	{0x1f442, "/z耳朵"},
	{0x1f443, "/z鼻子"},
	{0x1f444, "/z嘴唇"},
	{0x1f446, "/z向上"},
	{0x1f447, "/z向下"},
	{0x1f448, "/z向左"},
	{0x1f449, "/z向右"},
	{0x1f44a, "/z出拳"},
	{0x1f44b, "/z手掌"},
	{0x1f44c, "/zOK"},
	{0x1f44d, "/z强"},
	{0x1f44e, "/z鄙视"},
	{0x1f44f, "/z鼓掌"},
	{0x1f450, "/z双手"},
	{0x1f451, "/z皇冠"},
	{0x1f452, "/z草帽"},
	{0x1f454, "/z衬衫"},
	{0x1f455, "/z上衣"},
	{0x1f457, "/z连衣裙"},
	{0x1f458, "/z和服"},
	{0x1f459, "/z内衣"},
	{0x1f45c, "/z女包"},
	{0x1f45f, "/z男鞋"},
	{0x1f460, "/z高跟鞋"},
	{0x1f461, "/z女鞋"},
	{0x1f462, "/z靴子"},
	{0x1f463, "/z脚印"},
	{0x1f466, "/z男孩"},
	{0x1f467, "/z女孩"},
	{0x1f468, "/z爸爸"},
	{0x1f469, "/z妈妈"},
	{0x1f46b, "/z情侣"},
	{0x1f46e, "/z警察"},
	{0x1f46f, "/z跳舞"},
	{0x1f471, "/z学生"},
	{0x1f472, "/z小贩"},
	{0x1f473, "/z农民"},
	{0x1f474, "/z爷爷"},
	{0x1f475, "/z奶奶"},
	{0x1f476, "/z宝宝"},
	{0x1f477, "/z工人"},
	{0x1f478, "/z公主"},
	{0x1f47b, "/z小鬼"},
	{0x1f47c, "/z天使"},
	{0x1f47d, "/z外星人"},
	{0x1f47e, "/z打怪"},
	{0x1f47f, "/z魔鬼"},
	{0x1f480, "/z骷髅"},
	{0x1f481, "/z摆手"},
	{0x1f482, "/z士兵"},
	{0x1f483, "/z美女"},
	{0x1f484, "/z口红"},
	{0x1f485, "/z美甲"},
	{0x1f486, "/z洗头"},
	{0x1f487, "/z剪发"},
	{0x1f488, "/z理发店"},
	{0x1f489, "/z针管"},
	{0x1f48a, "/z药丸"},
	{0x1f48b, "/z吻"},
	{0x1f48d, "/z戒指"},
	{0x1f48e, "/z钻石"},
	{0x1f48f, "/z接吻"},
	{0x1f490, "/z康乃馨"},
	{0x1f491, "/z爱情"},
	{0x1f492, "/z爱心教堂"},
	{0x1f493, "/z喜欢"},
	{0x1f494, "/z心碎"},
	{0x1f497, "/z粉心"},
	{0x1f498, "/z爱神箭"},
	{0x1f499, "/z篮心"},
	{0x1f49a, "/z绿心"},
	{0x1f49b, "/z黄心"},
	{0x1f49c, "/z紫心"},
	{0x1f49d, "/z爱的礼物"},
	{0x1f49f, "/z心"},
	{0x1f4a1, "/z灯泡"},
	{0x1f4a2, "/z青筋"},
	{0x1f4a3, "/z炸弹"},
	{0x1f4a4, "/z睡觉"},
	{0x1f4a6, "/z水滴"},
	{0x1f4a8, "/z喷气"},
	{0x1f4a9, "/z便便"},
	{0x1f4aa, "/z肌肉"},
	{0x1f4b0, "/z金钱"},
	{0x1f4b9, "/z股价"},
	{0x1f4ba, "/z座椅"},
	{0x1f4bb, "/z电脑"},
	{0x1f4bc, "/z男包"},
	{0x1f4bd, "/z唱片"},
	{0x1f4bf, "/z光盘"},
	{0x1f4c0, "/zCD"},
	{0x1f4d6, "/z书"},
	{0x1f4dd, "/z写字"},
	{0x1f4e0, "/z传真"},
	{0x1f4e1, "/z广播"},
	{0x1f4e2, "/z大喇叭"},
	{0x1f4e3, "/z小喇叭"},
	{0x1f4e9, "/z来信"},
	{0x1f4eb, "/z收件箱"},
	{0x1f4ee, "/z信箱"},
	{0x1f4f1, "/z手机"},
	{0x1f4f2, "/z来电"},
	{0x1f4f3, "/z手机"},
	{0x1f4f4, "/z关机"},
	{0x1f4f6, "/z信号"},
	{0x1f4f7, "/z相机"},
	{0x1f4fa, "/z电视"},
	{0x1f4fb, "/z收音机"},
	{0x1f4fc, "/z磁带"},
	{0x1f50a, "/z声音"},
	{0x1f512, "/z锁头"},
	{0x1f513, "/z开锁"},
	{0x1f514, "/z铃铛"},
	{0x1f51d, "/z顶"},
	{0x1f51e, "/z十八禁"},
	{0x1f525, "/z火焰"},
	{0x1f528, "/z榔头"},
	{0x1f52b, "/z手枪"},
	{0x1f52f, "/z星座"},
	{0x1f530, "/z盾牌"},
	{0x1f531, "/z金冠"},
	{0x1f532, "/z绿"},
	{0x1f533, "/z紫"},
	{0x1f534, "/z红"},
	{0x1f550, "/z一点"},
	{0x1f551, "/z二点"},
	{0x1f552, "/z三点"},
	{0x1f553, "/z四点"},
	{0x1f554, "/z五点"},
	{0x1f555, "/z六点"},
	{0x1f556, "/z七点"},
	{0x1f557, "/z八点"},
	{0x1f558, "/z九点"},
	{0x1f559, "/z十点"},
	{0x1f55a, "/z十一点"},
	{0x1f55b, "/z十二点"},
	{0x1f5fb, "/z富士山"},
	{0x1f5fc, "/z东京塔"},
	{0x1f5fd, "/z自由女神"},
	{0x1f601, "/z呲牙"},
	{0x1f602, "/z笑抽"},
	{0x1f603, "/z开心"},
	{0x1f604, "/z大笑"},
	{0x1f609, "/z挤眼"},
	{0x1f60a, "/z可爱"},
	{0x1f60c, "/z思考"},
	{0x1f60d, "/z色"},
	{0x1f60f, "/z奸笑"},
	{0x1f612, "/z无感"},
	{0x1f613, "/z汗"},
	{0x1f614, "/z惆怅"},
	{0x1f616, "/z崩溃"},
	{0x1f618, "/z飞吻"},
	{0x1f61a, "/z亲亲"},
	{0x1f61c, "/z调皮"},
	{0x1f61d, "/z赖皮"},
	{0x1f61e, "/z伤心"},
	{0x1f620, "/z生气"},
	{0x1f621, "/z发怒"},
	{0x1f622, "/z流泪"},
	{0x1f623, "/z晕"},
	{0x1f625, "/z流汗"},
	{0x1f628, "/z衰"},
	{0x1f62a, "/z瞌睡"},
	{0x1f62d, "/z大哭"},
	{0x1f630, "/z冷汗"},
	{0x1f631, "/z恐怖"},
	{0x1f632, "/z混乱"},
	{0x1f633, "/z发呆"},
	{0x1f637, "/z感冒"},
	{0x1f645, "/z交叉"},
	{0x1f646, "/z抱头"},
	{0x1f647, "/z考试"},
	{0x1f64c, "/z不是我"},
	{0x1f64f, "/z拜佛"}
};

static EmojiToChineseComp stEmojiComp;

static const char *EmotionCodeToChinese(uint16_t wUnicode)
{
	const EmojiToChinese stTarget = {wUnicode, NULL};
	const EmojiToChinese *pstRet =
		lower_bound(stEmojis, stEmojis + sizeof(stEmojis)/sizeof(stEmojis[0]), stTarget, stEmojiComp);
	if (pstRet != stEmojis + sizeof(stEmojis)/sizeof(stEmojis[0]) && pstRet->dwUnicode == wUnicode)
		return pstRet->szTips;
	else
		return NULL;
}

static const char *PhoneEmotionCodeToChinese(uint32_t dwUnicode)
{
	const EmojiToChinese stTarget = {dwUnicode, NULL};
	const EmojiToChinese *pstRet =
		lower_bound(stEmojis, stEmojis + sizeof(stEmojis)/sizeof(stEmojis[0]), stTarget, stEmojiComp);
	if (pstRet != stEmojis + sizeof(stEmojis)/sizeof(stEmojis[0]) && pstRet->dwUnicode == dwUnicode)
		return pstRet->szTips;
	else
		return NULL;
}

void ReplaceEmotionCode(string &sOutput, const string &sInput)
{
	sOutput.clear();
	sOutput.reserve(2048);
	
	const char *szInput = sInput.c_str();
	size_t i = 0;
	while (szInput[i] != '\0')
	{
		if (0xe0 == (szInput[i] & 0xf0)) //三字节
		{
			uint16_t wUnicode = Utf8ToUnicodeW(&szInput[i]);
			if (wUnicode >= 0xe001 && wUnicode <= 0xe537)
			{
				const char *sNew = EmotionCodeToChinese(wUnicode);
				if (sNew)
					sOutput += sNew;
				else
				{
					sOutput += szInput[i];
					sOutput += szInput[i+1];
					sOutput += szInput[i+2];
				}
			}
			else if (wUnicode == 0)
				break;
			else
			{
				sOutput += szInput[i];
				sOutput += szInput[i+1];
				sOutput += szInput[i+2];
			}
			i += 3;
		}
		else if (0xf0 == (szInput[i] & 0xff)) //四字节
		{
			uint32_t dwUnicode = Utf8ToUnicodeDW(&szInput[i]);
			if (dwUnicode >= 0x1f300 && dwUnicode <= 0x1f64f)
			{
				const char *sNew = PhoneEmotionCodeToChinese(dwUnicode);
				if (sNew)
					sOutput += sNew;
				else
				{
					sOutput += szInput[i];
					sOutput += szInput[i+1];
					sOutput += szInput[i+2];
					sOutput += szInput[i+3];
				}
			}
			else if (dwUnicode == 0)
				break;
			else
			{
				sOutput += szInput[i];
				sOutput += szInput[i+1];
				sOutput += szInput[i+2];
				sOutput += szInput[i+3];
			}
			i += 4;
		}
		else
		{
			sOutput += szInput[i];
			i++;
		}
	}
}
